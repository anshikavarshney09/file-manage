<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Our custom CSS -->
  <link href="/css/styles.css" rel="stylesheet">

  <!-- Remixicon CDN for icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css">

  <title>Drive â€“ Your Files</title>
</head>
<body class="page">

  <!-- TOP NAVBAR -->
  <header class="navbar">
    <div class="brand">
      Welcome, <span><%= user.username %></span> ðŸ‘‹
    </div>

    <div class="nav-actions">
      <!-- Upload button (NO onclick) -->
      <button type="button" class="btn btn-primary" id="uploadBtn">
        <i class="ri-upload-2-line"></i>
        <span>Upload File</span>
      </button>

      <a href="/user/logout" class="btn btn-danger">
        <i class="ri-logout-box-line"></i>
        <span>Logout</span>
      </a>
    </div>
  </header>

  <!-- MAIN CONTENT -->
  <main class="container">
    <section class="card">
      <h2 class="section-title">Your Files</h2>

      <% if (files.length === 0) { %>
        <div class="empty-state">
          <p>No files uploaded yet ðŸ˜”</p>
          <p>Click the <strong>Upload File</strong> button to get started.</p>
        </div>
      <% } else { %>
        <div class="file-list">
          <% files.forEach(file => { %>
            <div class="file-row">
              <div class="file-info">
                <i class="ri-file-2-line file-icon"></i>
                <span class="file-name"><%= file.originalName %></span>
              </div>
              <a href="/download/<%= file._id %>" target="_blank" class="icon-btn">
                <i class="ri-download-2-line"></i>
              </a>
            </div>
          <% }) %>
        </div>
      <% } %>
    </section>
  </main>

  <!-- UPLOAD POPUP -->
  <div id="popup" class="backdrop hidden">
    <div class="popup">
      <!-- close button (NO onclick) -->
      <button type="button" class="close-btn" id="closePopupBtn">
        <i class="ri-close-line"></i>
      </button>

      <h3 class="popup-title">Upload a file</h3>

      <form action="/upload" method="post" enctype="multipart/form-data">
        <label for="dropzone-file" class="dropzone">
          <i class="ri-cloud-upload-line dropzone-icon"></i>
          <p class="dropzone-title">Click to upload or drag and drop</p>
          <p class="dropzone-subtitle">Supports: JPG, PNG, GIF, PDF</p>
          <input id="dropzone-file" type="file" name="file" class="hidden-input">
        </label>

        <div class="popup-actions">
          <button type="submit" class="btn btn-primary">
            <i class="ri-upload-2-line"></i>
            <span>Upload Now</span>
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- External JS file (CSP friendly) -->
  <script src="/js/homepage.js" defer></script>
</body>
</html>
